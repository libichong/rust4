
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>正态分布 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="info.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="info.html">
            
                <a href="info.html">
            
                    
                    概率论与数理统计
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="info.html">
            
                <a href="info.html">
            
                    
                    首页
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.2" data-path="正态分布.html">
            
                <a href="正态分布.html">
            
                    
                    正态分布
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >正态分布</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="introduction">Introduction</h3>
<p>In ordinary probability theory courses, the course instructor would usually not emphasize the concepts and properties of the multivariate Gaussian distribution. However, multivariate Gaussian distribution is actually quite widely used in many different models. So here we are going to fill some holes in the probability theory we learned.</p>
<h3 id="multivariate-gaussian-distribution">Multivariate Gaussian Distribution</h3>
<p>If a random vector variable $x$ follows a multivariate Gaussian distribution with mean $\mu$ and covariance matrix $\Sigma$, its probability density function (pdf) is given by:</p>
<p><script type="math/tex; ">p(x; \mu, \Sigma) = \frac{1}{(2\pi)^{n/2} |\Sigma|^{1/2}} \exp{(-\frac{1}{2}(x-\mu)^T \Sigma^{-1} (x-\mu))}</script></p>
<p>We write this as $x \sim \mathcal{N}(\mu, \Sigma)$.</p>
<p><br></p>
<p>To understand the multivariate Gaussian distribution properly, we need to first understand the covariance matrix.</p>
<h3 id="covariance-matrix">Covariance Matrix</h3>
<p>Covariance is actually the critical part in multivariate Gaussian distribution. We will first look at some of the properties of the covariance matrix and try to proof them. </p>
<p>The two major properties of the covariance matrix are:</p>
<ul>
<li>Covariance matrix is positive semi-definite.</li>
<li>Covariance matrix in multivariate Gaussian distribution is positive definite.</li>
</ul>
<p>A symmetric matrix $M$ is said to be positive semi-definite if $y^TMy$ is always non-negative for any vector $y$.</p>
<p><br></p>
<p>Similarly, a symmetric matrix $M$ is said to be positive definite if $y^TMy$ is always positive for any non-zero vector $y$.</p>
<h4 id="covariance-matrix-is-positive-semi-definite">Covariance matrix is positive semi-definite</h4>
<p>We will first see covariance matrix is positive semi-definite.</p>
<p><br></p>
<p>By definition, given a random vector $x$, the covariance matrix is:</p>
<p><script type="math/tex; ">\Sigma = E[(x-\mu)(x-\mu)^T]</script></p>
<p>For any vector $v$, we have:</p>
<p><script type="math/tex; ">v^T \Sigma v = v^T E[(x-\mu)(x-\mu)^T] v = E[((x-\mu)^T v)^T ((x-\mu)^T v)] = E[((x-\mu)^T v)^2] \geq 0</script></p>
<p>Therefore, covariance matrix is positive semi-definite.</p>
<h4 id="covariance-matrix-in-multivariate-gaussian-distribution-is-positive-definite">Covariance matrix in multivariate Gaussian distribution is positive definite</h4>
<p>Now we need to see why the covariance matrix in multivariate Gaussian distribution is positive definite.</p>
<p><br></p>
<p>Notice from the pdf of the multivariate Gaussian distribution that the covariance matrix $\Sigma$ must be invertible, otherwise the pdf does not exist.</p>
<p><br></p>
<p>Because $\Sigma$ is intertible, it must be full rank, and linear system $\Sigma x = 0$ only has single solution $x = 0$.</p>
<p><br></p>
<p>From lemma 2, because $\Sigma$ is symmetric, we know that $\Sigma$ could be decomposed as $\Sigma = B^T B$.</p>
<p><br></p>
<p>Therefore, for any non-zero vector $y$, $y^T \Sigma y = 0$ if and only if $By = 0$. Because $y^T \Sigma y = y^T B^T B y = (By)^T (By)$. If $By = 0$, $\Sigma y = B^T By = 0$. Because $\Sigma$ is full rank, and $y \neq 0$, there is no solution for linear system $y^T \Sigma y = 0$. Therefore, $y^T \Sigma y &gt; 0$ and $\Sigma$ is positive definite. </p>
<h4 id="significance">Significance</h4>
<p>From lemma 3, we know that $\Sigma^{-1}$ is also positive definite.</p>
<p><br></p>
<p>We have proved all the way to show that $\Sigma^{-1}$ is positive definite, why would we need to know this? </p>
<p><br></p>
<p>In the pdf of multivariate Gaussian, $(x-\mu)^T \Sigma^{-1} (x-\mu)$ is always greater than 0, and $\exp{(-\frac{1}{2}(x-\mu)^T \Sigma^{-1} (x-\mu))}$ is always less than 1.</p>
<h3 id="multivariate-gaussian-distribution-properties">Multivariate Gaussian Distribution Properties</h3>
<p>We now could move to learn some Gaussian distribution properties.</p>
<h4 id="gaussian-properties">Gaussian Properties</h4>
<ol>
<li>The sum of independent Gaussian random variables is Gaussian.</li>
<li>The marginal of a joint Gaussian distribution is Gaussian.</li>
<li>The conditional of a joint Gaussian distribution is Gaussian.</li>
</ol>
<p>The proof of these properties are rather complicated. The reference to these proofs are provided in the reference 2.</p>
<h4 id="example-facts">Example Facts</h4>
<p>Suppose the real, scalar random variables $X$, $Y$, and $Z$ are jointly Gaussian. We could infer that:</p>
<ol>
<li>$X$, $Y$, and $Z$ independently are Gaussians because of the Gaussian property 2.</li>
<li>$2X+Y-Z$ is Gaussian because of the Gaussian property 1 and example fact 1.</li>
<li>$X|Y$ is Gaussian because of the Gaussian property 3.</li>
<li>$X|Y,Z$ is Gaussian.</li>
</ol>
<p>Example fact 4 might not be obvious. Here we could show using the Gaussian property 3 and conditional probability theorem without formal proof.</p>
<p><br></p>
<p>Because $p(X|Y,Z) = p(X|Y) \times p(Y|Z)$, $p(X|Y)$ and $p(Y|Z)$ are the pdf of Gaussian distribution we know from the Gaussian property 3. The product of two Gaussian pdf is a pdf of a new Gaussian (<a href="https://ccrma.stanford.edu/~jos/sasp/Product_Two_Gaussian_PDFs.html" target="_blank">Demo</a> and <a href="http://www.tina-vision.net/docs/memos/2003-003.pdf" target="_blank">formal proof</a>). </p>
<h3 id="lemmas">Lemmas</h3>
<p>These are the lemmas that I proved to support part of the statements in this blog post.</p>
<h4 id="lemma-1">Lemma 1</h4>
<p><strong>A symmetric matrix is positive definite if and only if its eigenvalues are all positive.</strong></p>
<p><br></p>
<p>Proof:</p>
<p><br></p>
<p>Any square symmetric matrix $M$ could be eigendecomposed (<a href="https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix#Real_symmetric_matrices" target="_blank">Wikipedia</a>). $M = P^{-1}DP = P^TDP$ (For symmetric matrix, $P$ is orthonormal, $P^{-1} = P^T$) where $D$ is the diagnal eigenvalue matrix. $y^TMy = y^TP^TDPy = (Py)^TD(Py)$. Because $D$ is diagnal, $(Py)^T(Py)$ is non-negative, therefore, $M$ is positive definite if and only if all the diagnal elements, i.e., the eigenvalues of $M$, are positive.</p>
<h4 id="lemma-2">Lemma 2</h4>
<p><strong>A symmetric matrix $A$ could be decomposed as $A = B^T B$ where $B$ is also a square matrix</strong></p>
<p><br></p>
<p>Proof:</p>
<p><br></p>
<p>$A = P^TDP = P^T (D^{1/2})^T D^{1/2} P = (D^{1/2} P)^T (D^{1/2} P) = B^T B$, where $B = D^{1/2} P$</p>
<h4 id="lemma-3">Lemma 3</h4>
<p><strong>If matrix $K$ is positive definite, then $K^{-1}$ is also positive definite.</strong></p>
<p><br></p>
<p>Proof:</p>
<p><br></p>
<p>From lemma 1, we know that if $K$ is positive definite, all the eigenvalues of $K$ is positive. Therefore, the determinant of $K$ is positive, and $K$ must be invertible.</p>
<p><br></p>
<p>For any vector non-zero $y$, we could always express $y$ as $y = Kx$ because $K$ is invertible. Given $K$ is positive definite and $v^T K v &gt; 0$ for any non-zero vector $v$. </p>
<p><br></p>
<p>Then we have:</p>
<p><script type="math/tex; ">y^T K^{-1} y = (Kx)^T K^{-1} Kx = x^T K^T (K^{-1} K) x = x^T K^T x = (x^T K x)^T > 0</script></p>
<p>Therefore, $K^{-1}$ is also positive definite.</p>
<h3 id="references">References</h3>
<p>The references below provide a lot of useful properties and facts without showing some of the detailed self-contained subtle proofs I provided above.</p>
<p><br></p>
<p>[1] <a href="../downloads/blog/2018-03-30-Multivariate-Gaussian-Covariance-Matrix/multivariate_gaussian_stanford.pdf">The Multivariate Gaussian Distribution</a></p>
<p>[2] <a href="../downloads/blog/2018-03-30-Multivariate-Gaussian-Covariance-Matrix/multivariate_gaussian_more_stanford.pdf">More on Multivariate Gaussians</a></p>
<p>[3] <a href="../downloads/blog/2018-03-30-Multivariate-Gaussian-Covariance-Matrix/product_of_gaussian_pdf.pdf">Products and Convolutions of Gaussian Probability Density Functions</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="info.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: 首页">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"正态分布","level":"1.2.2","depth":2,"previous":{"title":"首页","level":"1.2.1","depth":2,"path":"ProbabilityTheory/info.md","ref":"ProbabilityTheory/info.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["mathjax"],"pluginsConfig":{"mathjax":{"forceSVG":false,"version":"2.6-latest"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"ProbabilityTheory/正态分布.md","mtime":"2020-12-29T08:37:19.742Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-12-29T08:57:16.199Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

